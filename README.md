# otus-microservice-architecture-hw
Репозиторий домашних заданий по курсу "Архитектура микросервисов"

ООО «Рога и копыта» разрабатывает и продаёт коробочное ПО юр. лицам. У компании портал для клиентов, где они управляют лицензиями на купленное ПО и общаются с технической поддержкой. Дела идут в гору, поэтому портал скоро перестанёт справляться с нагрузкой. Кроме того, функциональность портала разростается, что требует выделения отдельных команд из отдела разработки портала. Информация о покупках поступает в портал из другого сервиса, работа с запросами ТП производится в другом сервсе, портал является для него фасадом. Продуктовые команды выкладывают новые версии в S3 хранилище.

## Пользовательские сценарии
- Как клиент, я хочу просматривать и скачивать лицензии и сертификаты ТП на моё ПО  
- Как клиент, я хочу видеть и скачивать образы, обновления и документацию на моё ПО  
- Как клиент, я хочу получать уведомления о выходе новых версий, обновлений и исправлении  уязвимостей моего ПО  
- Как клиент, я хочу получать уведомления об истечения срока действий лицензий и сертификатов на моё ПО  
- Как клиент, я хочу создавать запросы в поддержку и получать уведомления по ним
- Как клиент, я хочу передавать лицензии и сертификаты ТП в дочерние организации
- Как клиент, я хочу добавлять пользователей в свою и дочерние организации
- Как клиент, я хочу просматривать отчёт по лицензиям, сертификатам ТП и запросам в ТП  
- Как сотрудник, я хочу просматривать отчёт по лицензиям, сертификатам ТП и запросам в ТП клиентов
- Как сотрудник, я хочу добавлять новые продукты в портал

## Схема взаимодействия сервисов
[<img src="https://raw.githubusercontent.com/toolen/otus-microservice-architecture-hw/refs/heads/hw-01/%D0%A1%D1%85%D0%B5%D0%BC%D0%B0%20%D0%B2%D0%B7%D0%B0%D0%B8%D0%BC%D0%BE%D0%B4%D0%B5%D0%B9%D1%81%D1%82%D0%B2%D0%B8%D1%8F%20%D1%81%D0%B5%D1%80%D0%B2%D0%B8%D1%81%D0%BE%D0%B2.png">](https://github.com/toolen/otus-microservice-architecture-hw/blob/hw-01/%D0%A1%D1%85%D0%B5%D0%BC%D0%B0%20%D0%B2%D0%B7%D0%B0%D0%B8%D0%BC%D0%BE%D0%B4%D0%B5%D0%B9%D1%81%D1%82%D0%B2%D0%B8%D1%8F%20%D1%81%D0%B5%D1%80%D0%B2%D0%B8%D1%81%D0%BE%D0%B2.png)

## Назначение и зоны ответственности сервисов
### API Gateway
Точка входа. Агрегация API сервисов. Валидация JWT токенов.

### Сервис авторизации и аутентификации
Хранение информации о пользователях. Генерация JWT токенов. Управление доступами пользователей к тем или иным сервисам.

### Сервис лицензий и сертификатов
Хранение информации о лицензиях и сертификатах, их сроках действия,принадлежности к организациям, добавлении новых.

### Сервис продукты
Хранение и управление информации о продуктах, их параметрах, версиях, расположении в s3

### Сервис генерации ПДФ
Генерирование лицензий и сертификатов в виде пдф файлов, хранение шаблонов лицензий и сертификатов для каждого продукта

### Сервис организаций
Хранение и управление информации об организациях, их типах и отношений м/у собой

### Сервис работы с S3
Предоставление списков артефактов по лицензиям, скачиваний, агрегирования артефактов в архивы.

### Сервис нотификаций
Предоставление списка нотификаций, рассылка уведомлений на почту по событиям, рассылка регулярных уведомлений.

### Сервис запросов в техническую поддержку
Создание и ведение запросов в техническую поддержку.

### Сервис отчётов
Генерирование отчётов по лицензиям, сертификам, запросам в ТП.

## Контракты взаимодействия сервисов
### Сервис авторизации и аутентификации
`POST /api/v1/jwt` - возвращает access и refresh токен, если пользователь ввёл правильные логин и пароль  
`POST /api/v1/jwt/refresh` - возвращает новый access токен, если запрос сделан валидным refresh токеном  
`GET /api/v1/me` - возвращает информацию о пользователе его организации и правах  

### Сервис лицензий и сертификатов
`GET /api/v1/licenses` - возвращает список лицензий организации пользователя  
`GET /api/v1/licenses/{id}` - возвращает конкретную лицензий организации пользователя  
`GET /api/v1/certificates` - возвращает список сертификатов организации пользователя  
`GET /api/v1/certificates/{id}` - возвращает конкретный сертификат организации пользователя  

### Сервис продукты
`GET /api/v1/products` - возвращает список продуктов поддерживаемых порталом  
`GET /api/v1/products/{id}` - возыращает информацию о конкретном продукте  
`POST /api/v1/products` - создаёт новый продукт  
`PATCH /api/v1/products/{id}` - редактирует продукт  

### Сервис генерации ПДФ
`GET /api/v1/licenses/{id}` - возвращает ПДФ лицензии  
`GET /api/v1/certificates/{id}` - возвращает ПДФ сертификата  

### Сервис организаций
`POST /api/v1/cabinets` - создаёт новую организацию  
`GET /api/v1/cabinets/{id}` - возвращает информацию об организации  
`PATCH /api/v1/cabinets/{id}` - редактирует организацию  

### Сервис работы с S3
`GET /api/v1/licenses/{id}/images` - возвращает список артефактов доступных для скачивания по лицензии

### Сервис нотификаций
`GET /api/v1/notifications` - возвращает список нотификаций  
`POST /api/v1/notifications` - созадёт нотификацию  
`PATCH /api/v1/notifications/{id}` - редактирует нотификацию  
`DELETE /api/v1/notifications/{id}` - удаляет нотификацию  

### Сервис запросов в техническую поддержку
`GET /api/v1/issues` - возвращает список запросов  
`POST /api/v1/issues` - создаёт запрос ТП  
`PATCH /api/v1/issues/{id}` - редактирует запрос ТП  
`GET /api/v1/issues/{id}/comments` - возвращает список комментариев к запросу ТП  
`POST /api/v1/issues/{id}/comments` - создаёт комментарий к запросу ТП  
`PATCH /api/v1/issues/{id}/comments/{id}` - редактирует комментарий к запросу ТП  
`DELET /api/v1/issues/{id}/comments/{id}` - удаляет комментарий к запросу ТП  
`GET /api/v1/issues/{id}/attachments` - возвращает список атачментов к запросу ТП  
`GET /api/v1/issues/{id}/attachments/{id}` - скачивание конкретного атачмента запроса ТП  
`DELETE /api/v1/issues/{id}/attachments/{id}` - удаление конкретного атачмента запроса ТП  

### Сервис отчётов
`GET /api/v1/licenses?format={pdf|csv|xlsx}&cabinet_id={id}` - генерирует список лицензий организации пользователя в указаном формате, сотрудники могу передать идентификатор интересующей организации  
`GET /api/v1/certificates?format={pdf|csv|xlsx}&cabinet_id={id}` - генерирует список сертификатов организации пользователя в указаном формате, сотрудники могу передать идентификатор интересующей организации  
`GET /api/v1/issues?format={pdf|csv|xlsx}&cabinet_id={id}` - генерирует список запросов ТП организации пользователя в указаном формате, сотрудники могу передать идентификатор интересующей организации  
